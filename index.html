<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Observatoire PMEESA - Prototype Interactif</title>
    <script src="[https://cdn.jsdelivr.net/npm/chart.js](https://cdn.jsdelivr.net/npm/chart.js)"></script>
    <script src="[https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js](https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js)"></script>
    <script src="[https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js](https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js)"></script>
    <style>
        :root {
            --cm-green: #007A5E; /* [1, 2] */
            --cm-red: #CE1126;
            --cm-yellow: #FCD116;
            --light-gray: #f4f7f6;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: var(--light-gray); margin: 0; color: #333; }
       .header { background: var(--cm-green); color: white; padding: 1.5rem; text-align: center; border-bottom: 5px solid var(--cm-yellow); position: sticky; top: 0; z-index: 1000; }
       .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        
        /* KPI Cards */
       .kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
       .card { background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow); border-top: 5px solid var(--cm-red); text-align: center; }
       .card h3 { margin: 0; font-size: 0.9rem; color: #666; text-transform: uppercase; }
       .card.value { font-size: 2rem; font-weight: bold; margin: 10px 0; color: var(--cm-green); }
       .card.trend { font-size: 0.85rem; font-weight: bold; }
       .trend.up { color: #28a745; }

        /* Visualization Section */
       .viz-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 20px; margin-bottom: 30px; }
       .chart-container { background: white; padding: 20px; border-radius: 12px; box-shadow: var(--shadow); }
       .chart-container h2 { font-size: 1.1rem; margin-top: 0; border-left: 4px solid var(--cm-green); padding-left: 10px; }

        /* Questionnaire Section */
       .form-section { background: white; padding: 25px; border-radius: 12px; box-shadow: var(--shadow); margin-bottom: 30px; }
       .form-section h2 { margin-top: 0; color: var(--cm-green); }
       .iframe-wrapper { position: relative; padding-bottom: 56.25%; height: 600px; overflow: hidden; border: 2px solid #eee; border-radius: 8px; }
       .iframe-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        /* Report Button */
       .action-bar { text-align: center; margin-bottom: 50px; }
       .btn-report { background: var(--cm-red); color: white; padding: 18px 40px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: bold; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 15px rgba(206, 17, 38, 0.3); }
       .btn-report:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(206, 17, 38, 0.4); }
        
        footer { text-align: center; padding: 20px; color: #777; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="header">
    <h1>Tableau de Bord Statistique PMEESA</h1>
    <p>Modernisation du Syst√®me d'Information - R√©publique du Cameroun</p>
</div>

<div class="container">
    <div class="kpi-row">
        <div class="card">
            <h3>Stock Total PME (2024)</h3>
            <div class="value">443 524</div>
            <div class="trend up">‚ñ≤ +12,8 % vs 2023</div>
        </div>
        <div class="card">
            <h3>Nouvelles Cr√©ations</h3>
            <div class="value">21 132</div>
            <div class="trend">Record CFCE</div>
        </div>
        <div class="card">
            <h3>OES cr√©√©es</h3>
            <div class="value">3 909</div>
            <div class="trend up">‚ñ≤ +10,0 %</div>
        </div>
        <div class="card">
            <h3>Emplois (Pr√©visionnels)</h3>
            <div class="value">97 000+</div>
            <div class="trend">Impact Social Fort</div>
        </div>
    </div>

    <div class="viz-section" id="dashboard-viz">
        <div class="chart-container">
            <h2>R√©partition du Stock par Secteur (%)</h2>
            <canvas id="sectorChart"></canvas>
        </div>
        <div class="chart-container">
            <h2>Top Villes (Cr√©ations PME 2024)</h2>
            <canvas id="regionChart"></canvas>
        </div>
    </div>

    <div class="form-section">
        <h2>Interface de Saisie Num√©rique</h2>
        <p>Int√©gration du formulaire KoboToolbox pour la collecte terrain en temps r√©el.</p>
        <div class="iframe-wrapper">
            <iframe src="[https://ee.kobotoolbox.org/x/demo_form_simulated](https://ee.kobotoolbox.org/x/demo_form_simulated)" title="Questionnaire PMEESA"></iframe>
        </div>
    </div>

    <div class="action-bar">
        <button class="btn-report" onclick="generateAutomatedReport()">
            üìù R√âDIGER AUTOMATIQUEMENT LE RAPPORT (PDF)
        </button>
    </div>
</div>

<footer>
    ¬© 2026 - Minist√®re des PME, de l'√âconomie Sociale et de l'Artisanat (MINPMEESA)
</footer>

<script>
// --- Initialisation des graphiques (Donn√©es: [3, 4]) ---
document.addEventListener('DOMContentLoaded', function() {
    // Graphique Sectoriel
    new Chart(document.getElementById('sectorChart'), {
        type: 'doughnut',
        data: {
            labels:,
            datasets: [{
                data: [77.2, 22.7, 0.1],
                backgroundColor:,
                borderWidth: 2
            }]
        },
        options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
    });

    // Graphique R√©gional (Top CFCE)
    new Chart(document.getElementById('regionChart'), {
        type: 'bar',
        data: {
            labels:,
            datasets: [{
                label: 'Nombre de PME cr√©√©es',
                data: ,
                backgroundColor: '#007A5E'
            }]
        },
        options: { indexAxis: 'y', responsive: true, scales: { x: { beginAtZero: true } } }
    });
});

// --- Logique de R√©daction Automatique [5, 6, 7] ---
async function generateAutomatedReport() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF('p', 'mm', 'a4');
    
    // Capture de la zone de visualisation
    const vizElement = document.getElementById('dashboard-viz');
    const canvas = await html2canvas(vizElement);
    const imgData = canvas.toDataURL('image/png');

    // Mise en page du PDF
    doc.setFont("helvetica", "bold");
    doc.setFontSize(18);
    doc.setTextColor(0, 122, 94); // Vert Cameroun
    doc.text("RAPPORT D'ANALYSE STATISTIQUE PMEESA 2024", 105, 20, { align: 'center' });
    
    doc.setFont("helvetica", "normal");
    doc.setFontSize(10);
    doc.setTextColor(100);
    doc.text("G√©n√©r√© automatiquement par le syst√®me d'information int√©gr√©", 105, 27, { align: 'center' });

    // Section Analyse Narrative [8, 4]
    doc.setFontSize(13);
    doc.setTextColor(0);
    doc.text("1. Constats Majeurs", 20, 45);
    
    doc.setFontSize(11);
    const narrativeText =;
    doc.text(narrativeText, 20, 55);

    // Insertion des graphiques
    doc.setFontSize(13);
    doc.text("2. Repr√©sentations Graphiques", 20, 100);
    doc.addImage(imgData, 'PNG', 15, 105, 180, 85);

    // Section Recommandations [9, 10]
    doc.setFontSize(13);
    doc.text("3. Orientations Strat√©giques", 20, 205);
    doc.setFontSize(11);
    const recommendations =;
    doc.text(recommendations, 20, 215);

    // Signature/Date
    const today = new Date().toLocaleDateString('fr-FR');
    doc.setFontSize(10);
    doc.text(`Fait √† Yaound√©, le ${today}`, 190, 270, { align: 'right' });

    // T√©l√©chargement
    doc.save(`Rapport_PMEESA_Auto_${today.replace(/\//g, '-')}.pdf`);
    alert("Votre rapport narratif a √©t√© g√©n√©r√© avec succ√®s en format PDF.");
}
</script>

</body>
</html>
